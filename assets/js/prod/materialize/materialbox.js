!function($){$.fn.materialbox=function(){return this.each(function(){function returnToOriginal(){doneAnimating=!1;var placeholder=origin.parent(".material-placeholder"),originalWidth=(window.innerWidth,window.innerHeight,origin.data("width")),originalHeight=origin.data("height");origin.velocity("stop",!0),$("#materialbox-overlay").velocity("stop",!0),$(".materialbox-caption").velocity("stop",!0),$("#materialbox-overlay").velocity({opacity:0},{duration:outDuration,queue:!1,easing:"easeOutQuad",complete:function(){overlayActive=!1,$(this).remove()}}),origin.velocity({width:originalWidth,height:originalHeight,left:0,top:0},{duration:outDuration,queue:!1,easing:"easeOutQuad"}),$(".materialbox-caption").velocity({opacity:0},{duration:outDuration,queue:!1,easing:"easeOutQuad",complete:function(){placeholder.css({height:"",width:"",position:"",top:"",left:""}),origin.css({height:"",top:"",left:"",width:"","max-width":"",position:"","z-index":""}),origin.removeClass("active"),doneAnimating=!0,$(this).remove()}})}if(!$(this).hasClass("initialized")){$(this).addClass("initialized");var overlayActive=!1,doneAnimating=!0,inDuration=275,outDuration=200,origin=$(this),placeholder=$("<div></div>").addClass("material-placeholder");origin.wrap(placeholder),origin.on("click",function(){var placeholder=origin.parent(".material-placeholder"),windowWidth=window.innerWidth,windowHeight=window.innerHeight,originalWidth=origin.width(),originalHeight=origin.height();if(doneAnimating===!1)return returnToOriginal(),!1;if(overlayActive&&doneAnimating===!0)return returnToOriginal(),!1;doneAnimating=!1,origin.addClass("active"),overlayActive=!0,placeholder.css({width:placeholder[0].getBoundingClientRect().width,height:placeholder[0].getBoundingClientRect().height,position:"relative",top:0,left:0}),origin.css({position:"absolute","z-index":1e3}).data("width",originalWidth).data("height",originalHeight);var overlay=$('<div id="materialbox-overlay"></div>').css({opacity:0}).click(function(){doneAnimating===!0&&returnToOriginal()});if($("body").append(overlay),overlay.velocity({opacity:1},{duration:inDuration,queue:!1,easing:"easeOutQuad"}),""!==origin.data("caption")){var $photo_caption=$('<div class="materialbox-caption"></div>');$photo_caption.text(origin.data("caption")),$("body").append($photo_caption),$photo_caption.css({display:"inline"}),$photo_caption.velocity({opacity:1},{duration:inDuration,queue:!1,easing:"easeOutQuad"})}var ratio=0,widthPercent=originalWidth/windowWidth,heightPercent=originalHeight/windowHeight,newWidth=0,newHeight=0;widthPercent>heightPercent?(ratio=originalHeight/originalWidth,newWidth=.9*windowWidth,newHeight=.9*windowWidth*ratio):(ratio=originalWidth/originalHeight,newWidth=.9*windowHeight*ratio,newHeight=.9*windowHeight),origin.hasClass("responsive-img")?origin.velocity({"max-width":newWidth,width:originalWidth},{duration:0,queue:!1,complete:function(){origin.css({left:0,top:0}).velocity({height:newHeight,width:newWidth,left:$(document).scrollLeft()+windowWidth/2-origin.parent(".material-placeholder").offset().left-newWidth/2,top:$(document).scrollTop()+windowHeight/2-origin.parent(".material-placeholder").offset().top-newHeight/2},{duration:inDuration,queue:!1,easing:"easeOutQuad",complete:function(){doneAnimating=!0}})}}):origin.css("left",0).css("top",0).velocity({height:newHeight,width:newWidth,left:$(document).scrollLeft()+windowWidth/2-origin.parent(".material-placeholder").offset().left-newWidth/2,top:$(document).scrollTop()+windowHeight/2-origin.parent(".material-placeholder").offset().top-newHeight/2},{duration:inDuration,queue:!1,easing:"easeOutQuad",complete:function(){doneAnimating=!0}})}),$(window).scroll(function(){overlayActive&&returnToOriginal()}),$(document).keyup(function(e){27===e.keyCode&&doneAnimating===!0&&overlayActive&&returnToOriginal()})}})},$(document).ready(function(){$(".materialboxed").materialbox()})}(jQuery);